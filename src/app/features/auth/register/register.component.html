<div class="auth-container">
  <div class="overlay">
    <div class="auth-card">
      <img src="assets/logo/mydoc-logo.svg" alt="MyDoc Appointment" class="logo mb-3" />
      <h2 class="mb-2">Create Account</h2>
      <p class="text-muted mb-4">Sign up to get started</p>

      <form (ngSubmit)="onSubmit()" #registerForm="ngForm" novalidate>
        <!-- Name -->
        <div class="mb-3">
          <input type="text"
                 name="name"
                 [(ngModel)]="name"
                 required
                 #nameCtrl="ngModel"
                 class="form-control"
                 placeholder="Full Name" />
          <div class="field-error" *ngIf="nameCtrl.invalid && (nameCtrl.dirty || nameCtrl.touched)">
            <small *ngIf="nameCtrl.errors?.['required']">Name is required.</small>
          </div>
        </div>

        <!-- Email -->
        <div class="mb-3">
          <input type="email"
                 name="email"
                 [(ngModel)]="email"
                 required
                 email
                 #emailCtrl="ngModel"
                 class="form-control"
                 placeholder="Email address" />
          <div class="field-error" *ngIf="emailCtrl.invalid && (emailCtrl.dirty || emailCtrl.touched)">
            <small *ngIf="emailCtrl.errors?.['required']">Email is required.</small>
            <small *ngIf="emailCtrl.errors?.['email']">Invalid email format.</small>
          </div>
        </div>

        <!-- Phone (10 digits) -->
        <div class="mb-3">
          <input type="tel"
                 name="phone"
                 [(ngModel)]="phone"
                 required
                 pattern="^[0-9]{10}$"
                 #phoneCtrl="ngModel"
                 class="form-control"
                 placeholder="Phone (10 digits)" />
          <div class="field-error" *ngIf="phoneCtrl.invalid && (phoneCtrl.dirty || phoneCtrl.touched)">
            <small *ngIf="phoneCtrl.errors?.['required']">Phone is required.</small>
            <small *ngIf="phoneCtrl.errors?.['pattern']">Phone must be exactly 10 digits.</small>
          </div>
        </div>

        <!-- Password -->
        <div class="mb-3">
          <input type="password"
                 name="password"
                 [(ngModel)]="password"
                 required
                 minlength="6"
                 #pwdCtrl="ngModel"
                 class="form-control"
                 placeholder="Password" />
          <div class="field-error" *ngIf="pwdCtrl.invalid && (pwdCtrl.dirty || pwdCtrl.touched)">
            <small *ngIf="pwdCtrl.errors?.['required']">Password is required.</small>
            <small *ngIf="pwdCtrl.errors?.['minlength']">Password must be at least 6 characters.</small>
          </div>
        </div>

        <!-- Optional fields -->
        <div class="row">
          <!-- DOB (cannot be future) -->
          <div class="col-12 col-sm-6 mb-3">
            <input type="date"
                   name="dob"
                   [(ngModel)]="dob"
                   #dobCtrl="ngModel"
                   class="form-control"
                   placeholder="Date of Birth" />
            <div class="field-error" *ngIf="dob && isFutureDate(dob)">
              <small>Date of Birth cannot be in the future.</small>
            </div>
          </div>

          <!-- Gender -->
          <div class="col-12 col-sm-6 mb-3">
            <select name="gender"
                    [(ngModel)]="gender"
                    #genderCtrl="ngModel"
                    class="form-select">
              <option [ngValue]="undefined">Gender (optional)</option>
              <option value="MALE">Male</option>
              <option value="FEMALE">Female</option>
              <option value="OTHER">Other</option>
            </select>
          </div>
        </div>

        <!-- Address -->
        <div class="mb-3">
          <textarea name="address"
                    [(ngModel)]="address"
                    #addrCtrl="ngModel"
                    rows="3"
                    class="form-control"
                    placeholder="Address (optional)"></textarea>
        </div>

        <button type="submit"
                class="btn btn-auth w-100"
                [disabled]="loading || registerForm.invalid || (dob && isFutureDate(dob))">
          {{ loading ? 'Registering...' : 'Register' }}
        </button>
      </form>

      <p class="mt-3 small">
        Already have an account?
        <a routerLink="/auth/login">Login</a>
      </p>

      <div *ngIf="errorMsg" class="alert alert-danger mt-3 py-2">
        {{ errorMsg }}
      </div>
      <div *ngIf="successMsg" class="alert alert-success mt-3 py-2">
        {{ successMsg }}
      </div>
    </div>
  </div>
</div>
